@import "variables";
@import "../../typography/variables";
@import "../../mixins";
@import "../../placeholders";
@import "uwp-buttons";
@import "button-base";

.u-btn {
  @extend %u-button-base;
  height: $u-btn-height;
  padding: 0 $u-btn-side-padding;
  line-height: $u-btn-material-line-height;
  border-radius: $u-btn-border-radius;
  transition: color 150ms ease-in-out, background-color 150ms ease-in-out, box-shadow 150ms ease-in-out;
}

.u-btn-set {
  display: inline-flex;

  .u-btn + .u-btn {
    margin-left: $u-btn-set-margin;
  }
}

.u-btn-flat,
.u-btn-solid {
  @extend .u-btn;
}

.u-btn-outline {
  @extend .u-btn-flat;
  border: $u-btn-outline-border-width solid currentColor;
}

.u-btn-raised {
  @extend .u-btn-solid;

  @include u-elevation(2);

  &:active {
    @include u-elevation(6);
  }

  transition: box-shadow 250ms;
}

.u-btn-icon {
  display: inline-block;
  width: $u-btn-icon-size;
  height: $u-btn-icon-size;
  margin-right: $u-btn-icon-margin-end;
  margin-left: $u-btn-icon-margin-start;
  font-size: $u-btn-icon-size;
  line-height: 1em;
}

.u-btn-icon-end {
  margin-right: $u-btn-icon-margin-start;
  margin-left: $u-btn-icon-margin-end;
}

.u-btn-borderless {
  @extend .u-btn;

  width: $u-btn-borderless-size;
  height: $u-btn-borderless-size;
  padding: 0;
  overflow: visible;
  border-radius: 50%;

  .u-btn-icon {
    width: $u-btn-borderless-icon-size;
    height: $u-btn-borderless-icon-size;
    margin: 0;
    font-size: $u-btn-borderless-icon-size;
  }
}

.u-btn-floating {
  @extend .u-btn-raised;
  width: $u-btn-floating-size;
  height: $u-btn-floating-size;
  border-radius: 50%;

  .u-btn-icon {
    width: $u-btn-borderless-icon-size;
    height: $u-btn-borderless-icon-size;
    margin: 0;
    font-size: $u-btn-borderless-icon-size;
  }
}

.u-btn-floating-extended {
  width: auto;
  height: $u-btn-floating-extended-height;
  padding-right: $u-btn-floating-extended-padding;
  padding-left: $u-btn-floating-extended-padding;
  border-radius: $u-btn-floating-extended-border-radius;

  .u-btn-icon {
    margin-right: $u-btn-floating-extended-icon-margin;
    margin-left: $u-btn-floating-extended-icon-margin - $u-btn-floating-extended-padding;
  }
}

.u-btn-floating-sm {
  width: $u-btn-floating-small-size;
  height: $u-btn-floating-small-size;
}

.dense {
  @at-root .dense-layout .u-btn,
  &.u-btn {
    height: $u-btn-dense-size;
    font-size: $u-btn-dense-font-size;
  }

  @at-root .dense-layout .u-btn-borderless,
  &.u-btn-borderless {
    width: $u-btn-dense-size;
    font-size: $base-dense-icon-size;
  }

  @at-root .dense-layout .u-btn-icon,
  &.u-btn-icon {
    font-size: $u-btn-icon-dense-size;
  }
}

%u-bg-light {
  .u-btn {
    &.disabled,
    &:disabled {
      color: $u-btn-disabled-color-light-theme !important;
      background-color: $u-btn-disabled-background-light-theme !important;
      box-shadow: none;

      &::before {
        background-color: transparent !important;
      }
    }
  }

  .u-btn-borderless,
  .u-btn-flat {
    &.disabled,
    &:disabled {
      &,
      &::before {
        background-color: transparent !important;
      }
    }
  }

  .u-btn-flat.u-btn-default {
    color: $u-btn-flat-default-background-light-theme;
  }

  .u-btn-borderless.u-btn-default {
    color: $u-btn-borderless-default-color-light-theme;
  }
}

%u-bg-dark {
  .u-btn {
    &.disabled,
    &:disabled {
      color: $u-btn-disabled-color-dark-theme !important;
      background-color: $u-btn-disabled-background-dark-theme;
      box-shadow: none;

      &::before {
        background-color: transparent !important;
      }
    }
  }

  .u-btn-borderless,
  .u-btn-flat {
    &.disabled,
    &:disabled {
      &,
      &::before {
        background-color: transparent;
      }
    }
  }

  .u-btn-flat.u-btn-default {
    color: $u-btn-flat-default-background-dark-theme;
  }

  .u-btn-borderless.u-btn-default {
    color: $u-btn-borderless-default-color-dark-theme;
  }
}

.rtl,
[dir="rtl"] {
  .u-btn-floating-extended {
    .u-btn-icon {
      margin-right: $u-btn-floating-extended-icon-margin - $u-btn-floating-extended-padding;
      margin-left: $u-btn-floating-extended-icon-margin;
    }
  }

  .u-btn-set {
    .u-btn + .u-btn {
      margin-right: $u-btn-set-margin;
      margin-left: 0;
    }
  }
}

@mixin button-flat-theme($buttons-colors) {

  @each $color, $value in $buttons-colors {
    .u-btn-flat.u-btn-#{$color} {
      @include button-flat-variant($value);
    }
  }
}

@mixin button-borderless-theme($buttons-colors) {
  @each $color, $value in $buttons-colors {
    .u-btn-borderless.u-btn-#{$color} {
      @include button-flat-variant($value);
    }
  }
}

@mixin u-buttons-theme {

  $theme-colors: map-get($u-theme, "colors");
  $dark-theme: map-get($u-theme, "dark");
  $default-style: map-get($u-theme, "default-style");

  $buttons-colors: (
    primary: map-get($theme-colors, "primary"),
    primary-variant: map-get($theme-colors, "primary-variant"),
    secondary: map-get($theme-colors, "secondary"),
    secondary-variant: map-get($theme-colors, "secondary-variant"),
    danger: map-get($theme-colors, "danger")
  );

  $u-btn-disabled-color: $u-btn-disabled-color-light-theme;
  $u-btn-disabled-background-color: $u-btn-disabled-background-light-theme;
  $u-btn-flat-default-color: $u-body-color-light-theme;
  $u-btn-borderless-color: $u-btn-borderless-default-color-light-theme;
  $u-btn-outline-gray-border-color: $u-btn-outline-gray-border-color-light-theme;

  @if ($dark-theme) {
    $u-btn-disabled-color: $u-btn-disabled-color-dark-theme;
    $u-btn-disabled-background-color: $u-btn-disabled-background-dark-theme;
    $u-btn-flat-default-color: $u-body-color-dark-theme;
    $u-btn-borderless-color: $u-btn-borderless-default-color-dark-theme;
    $u-btn-outline-gray-border-color: $u-btn-outline-gray-border-color-dark-theme;
  }

  .u-btn-solid.u-btn-default {
    @include button-solid-variant(if($dark-theme, $u-btn-solid-default-background-dark-theme, $u-btn-solid-default-background-light-theme));
  }

  @each $color, $value in $buttons-colors {
    .u-btn-solid.u-btn-#{$color} {
      @include button-solid-variant($value);
    }
  }

  .u-btn-outline-gray {
    @extend .u-btn-outline;
    border-color: $u-btn-outline-gray-border-color;
  }

  @include button-flat-theme($buttons-colors);
  @include button-borderless-theme($buttons-colors);

  @if ($default-style == "uwp") {
    @include uwp-button($dark-theme);
  }
}
